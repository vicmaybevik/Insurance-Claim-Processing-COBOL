# Data Structures
WORKING-STORAGE SECTION.
01 WS-CLAIM-RECORD.
   05 WS-CLAIM-ID           PIC X(10).
   05 WS-CUSTOMER-NAME      PIC X(30).
   05 WS-CLAIM-AMOUNT       PIC 9(7)V99.
   05 WS-CLAIM-STATE        PIC X(2).
   05 WS-CLAIM-STATUS       PIC X(10).

01 WS-COUNTERS.
   05 WS-TOTAL-CLAIMS       PIC 9(5) VALUE 0.
   05 WS-VALID-CLAIMS       PIC 9(5) VALUE 0.
   05 WS-REJECTED-CLAIMS    PIC 9(5) VALUE 0.

01 WS-FLAGS.
   05 WS-EOF-FLAG           PIC X VALUE 'N'.
      88 WS-EOF                   VALUE 'Y'.

01 WS-REPORT-RECORD.
   05 WS-REPORT-STATE       PIC X(2).
   05 WS-REPORT-TOTAL       PIC 9(5).
   05 WS-REPORT-VALID       PIC 9(5).
   05 WS-REPORT-REJECTED    PIC 9(5).

# Program Structure
IDENTIFICATION DIVISION.
PROGRAM-ID. CLAIM-PROCESS.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT CLAIM-FILE ASSIGN TO "claims.dat"
        ORGANIZATION IS LINE SEQUENTIAL.
    SELECT REPORT-FILE ASSIGN TO "report.out"
        ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD CLAIM-FILE.
01 FILE-CLAIM-RECORD.
   COPY "claim-record.cpy".
FD REPORT-FILE.
01 FILE-REPORT-RECORD.
   COPY "report-record.cpy".

WORKING-STORAGE SECTION.

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    PERFORM 100-INITIALIZE
    PERFORM 200-PROCESS-CLAIMS UNTIL WS-EOF
    PERFORM 300-GENERATE-REPORT
    PERFORM 400-CLEANUP
    STOP RUN.

100-INITIALIZE.
    * Initialize files and variables

200-PROCESS-CLAIMS.
    PERFORM 210-READ-CLAIM
    IF NOT WS-EOF
        PERFORM 220-VALIDATE-CLAIM
        PERFORM 230-ADJUDICATE-CLAIM
        PERFORM 240-UPDATE-COUNTERS
    END-IF.

210-READ-CLAIM.
    * Read a claim from the input file

220-VALIDATE-CLAIM.
    * Check if the claim is valid

230-ADJUDICATE-CLAIM.
    * Process the claim if it's valid

240-UPDATE-COUNTERS.
    * Update the claim counters

300-GENERATE-REPORT.
    * Create the final report

400-CLEANUP.
    * Close files and perform any necessary cleanup